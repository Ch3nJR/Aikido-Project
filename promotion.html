<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Homepage | aikiForest</title>
    <link rel="stylesheet" href="css/normalize.css" />
    <link rel="stylesheet" href="css/general.css" />
    <link rel="stylesheet" href="css/promotion.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <script src="https://unpkg.com/scrollreveal"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  </head>

  <body>
    <!--Scroll to top btn-->
    <div class="scrollToTop-btn flex-center">
      <i class="bi bi-arrow-up"></i>
    </div>

    <!--Navigation bar-->
    <div id="navBar"></div>

    <!--Promotion-->
    <section>
      <div class="promo-header flex-center">
        <h2>Limited Time Specials</h2>
      </div>

      <div class="promo-container">
        <div class="promo-card flex-center">
          <div class="promo-card-inner">
            <div class="front" id="promo1"></div>
            <div class="back">
              <h2>Bring a Friend (or family member)!</h2>
              <p>Your friend will get ONE free trial.</p>
              <p>
                Upon successful sign-up, your friend will get waiver off
                Registration Fee, worth $70.
              </p>

              <p>
                You will get ONE additional class to be redeemed as an add-on
                session/additional enhancement course, by next term.
              </p>

              <p>You will get $70 off for your next term fee payment.</p>
              <a
                href="https://docs.google.com/forms/d/e/1FAIpQLSdOVMJboBR4dApzQ6lb0IwO4nxju--GwfZhRODOrFZL5e2J_w/viewform "
                class="btn"
                >Sign Up</a
              >
            </div>
          </div>
          <div class="promo-btn flex-center">
            <p class="btn flip-btn">Details</p>
          </div>
        </div>

        <div class="promo-card flex-center">
          <div class="promo-card-inner">
            <div class="front" id="promo2"></div>
            <div class="back">
              <h2>June School Holiday Open Enhancement Course</h2>

              <p>Promotion Rates:</p>
              <p>$38 for 1 course</p>
              <p>$48 for 2 course</p>
              <p>$58 for 3 course</p>
              <p>4th course & above: $8 per additional course</p>
              <p>
                For any course purchase, you may add a regular Aikido trial
                class at $8 (U.P $38)
              </p>

              <em>
                <p>
                  Each course will be held in one of these locations: Alexandra
                  Retail Centre L3, SAFRA Toa Payoh L3, Rivervale Mall L2
                </p>
              </em>

              <a
                href="https://docs.google.com/forms/d/e/1FAIpQLSeHwRkU91BsEuXEZnkO1nBDYb5Hvs6JgzgJMWiKbJvNa7Xq8Q/viewform"
                class="btn"
                >Sign Up</a
              >
            </div>
          </div>
          <div class="promo-btn flex-center">
            <p class="btn flip-btn">Details</p>
          </div>
        </div>

        <div class="promo-card flex-center">
          <div class="promo-card-inner">
            <div class="front" id="promo3"></div>
            <div class="back">
              <h2>Holiday Add-On Promotion!</h2>
              <p>
                Promotion happens every 4 times a year on all school holidays.
              </p>
              <p>$12 per add-on class</p>
              <p>$50 for unlimited add-on classes</p>
              <p>
                The perfect opportunity for you to make up for missed trainings,
                accelerate grading process through more intensive trainings, and
                a supplement for better preparation for your next grading.
              </p>
            </div>
          </div>
          <div class="promo-btn flex-center">
            <p class="btn flip-btn">Details</p>
          </div>
        </div>
      </div>
    </section>

    <!--Footer-->
    <div id="footer"></div>

    <script src="js/general.js"></script>
    <script src="js/index.js"></script>

    <script type="module">
      // Import the functions you need from the SDKs you need (https://firebase.google.com/docs/web/learn-more#available-libraries)
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";

      import {
        getStorage,
        ref as strRef,
        uploadBytes,
        getDownloadURL,
      } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

      import {
        getDatabase,
        ref as DatabaseRef,
        set,
        child,
        get,
        onValue,
      } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

      // Your web app's Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyBpX4VZrjnFPrAi7Rwdjpz2p7_ZlGzIFk4",
        authDomain: "aikido-test-90953.firebaseapp.com",
        projectId: "aikido-test-90953",
        storageBucket: "aikido-test-90953.appspot.com",
        // The value of `databaseURL` depends on the location of the database
        databaseURL:
          "https://aikido-test-90953-default-rtdb.asia-southeast1.firebasedatabase.app/",
        messagingSenderId: "763006449505",
        appId: "1:763006449505:web:cd3895906b924be58a3720",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);

      // Initialize Cloud Storage and get a reference to the service
      const storage = getStorage(app);

      // Initialize Realtime Database and get a reference to the service
      const database = getDatabase(app);
      // Get promotions
      const promotions = DatabaseRef(database, "promotions");

      onValue(promotions, (snapshot) => {
        snapshot.forEach((promotion) => {
          const childKey = promotion.key.replace(/\s+/g, "");
          const childData = promotion.val();

          $(".promo-container")
            .append(
              `
                <div class="promo-card flex-center ${childKey}">
                  <div class="promo-card-inner">
                    <div class="front"></div>
                    <div class="back">
                      <h2>
                        ${childData.promo_name} (${childData.promo_price})
                      </h2>
                      ${childData.promo_desc}
                      ${
                        childData.promo_link
                          ? `<a class="btn" href="${childData.promo_link}">${childData.promo_link_txt}</a>`
                          : ""
                      }
                    </div>
                  </div>
                  <div class="promo-btn flex-center">
                    <p class="btn flip-btn">Details</p>
                  </div>
                </div>
              `
            )
            .find(".promo-card:last-child .flip-btn")
            .on("click", function () {
              $(this)
                .parent()
                .siblings(".promo-card-inner")
                .toggleClass("flip-card");
            });

          getDownloadURL(strRef(storage, childData.promo_img_ref))
            .then((url) => {
              $("." + childKey)
                .find(".front")
                .css("background-image", `url(${url})`);
            })
            .catch((error) => {
              console.log(error);
            });
        });
      });
    </script>
  </body>
</html>
